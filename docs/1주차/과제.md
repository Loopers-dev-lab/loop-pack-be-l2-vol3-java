# 1주차 과제: TDD

## TDD란?

- **Test Driven Development**: 테스트 주도 개발
- TEST 코드를 먼저 작성하고 테스트 코드가 통과되도록 실제 비즈니스 로직을 작성하는 것
- 보통 TLD(Test Last Development)로 개발을 많이 한다

---

## TDD의 3단계 사이클

| 단계 | 설명 |
|------|------|
| **Red (Fail)** | 구현하려는 기능에 대한 실패하는 코드를 먼저 작성 (기능 조차도 없는 단계) |
| **Green (Pass)** | 테스트를 통과할 수 있을 정도의 최소한의 기능을 구현 |
| **Refactor (Clean)** | 테스트 통과를 유지하면서 코드의 중복을 개선하고 가독성을 높이는 등 코드를 개선 |

---

## 테스트 종류

### 1. 단위 테스트 (Unit Test)

- **대상:** 함수, 메서드, 클래스 등 아주 작은 코드 단위
- **특징:** 외부 데이터베이스나 네트워크 연결 없이 독립적으로 실행됩니다
- **장점:** 실행 속도가 매우 빠르고(몇 밀리초 ms 단위), 문제가 어디서 발생했는지 정확히 알 수 있습니다
- **Java 도구:** JUnit, AssertJ, Mockito

### 2. 통합 테스트 (Integration Test)

- **대상:** 여러 모듈이나 컴포넌트가 결합했을 때의 상호작용
- **특징:** 실제 DB에 연결하거나 API를 호출하여 모듈 간의 연결에 문제가 없는지 확인합니다
- **장점:** 단위 테스트만으로는 발견하기 어려운 시스템 간의 정합성 문제를 찾습니다
- **Java 도구:** Spring Boot Test, Testcontainers

### 3. E2E 테스트 (End-to-End Test)

- **대상:** 사용자 관점에서의 전체 시나리오 (로그인부터 주문 완료까지 등)
- **특징:** 실제 브라우저를 띄우거나 앱을 실행하여 시스템 전체가 의도대로 동작하는지 검증합니다
- **장점:** 사용자가 실제로 겪을 수 있는 오류를 사전에 방지합니다
- **도구:** Selenium, Cypress, Playwright

---

## 테스트 작성 전략

- **안에서 밖으로 (Inside-Out):** 의존성 없는 것 → 의존성 있는 것 순서로 개발
  - 예: Domain -> Service -> Controller
- **밖에서 안으로 (Outside-In):** 사용자 인터페이스부터 시작하여 내부로 진행
  - 예: Controller -> Service -> Domain

---

## TDD 단계

### 1단계: 요구사항을 테스트 목록으로 분해

- 요구사항 문서나 기획서를 분석하여 **검증해야 할 항목**을 나열
- 각 항목은 **하나의 테스트 케이스**가 될 수 있도록 작게 분리
- 예시: "비밀번호는 8~16자" → "8자 미만이면 실패", "16자 초과하면 실패"

### 2단계: 테스트 작성 (Red)

- 아직 구현되지 않은 기능에 대한 테스트 코드 작성
- 테스트 실행 시 **반드시 실패**해야 함 (빨간불) - 필요한 클래스 조차 없는 상태
- Given-When-Then 패턴으로 작성

```java
@Test
void 비밀번호가_8자_미만이면_실패한다() {
    // given
    String password = "Short1!";

    // when & then
    assertThatThrownBy(() -> PasswordValidator.validate(password))
        .isInstanceOf(IllegalArgumentException.class);
}
```

### 3단계: 최소 구현 (Green)

- 테스트를 통과하는 **가장 간단한 코드** 작성
- 완벽한 코드가 아니어도 됨, 일단 통과만 시키기
- 하드코딩도 허용 (나중에 리팩토링)

```java
public class PasswordValidator {
    public static void validate(String password) {
        if (password.length() < 8) {
            throw new IllegalArgumentException("비밀번호는 8자 이상이어야 합니다.");
        }
    }
}
```

### 4단계: 리팩토링 (Refactor)

- 테스트가 통과하는 상태를 유지하면서 코드 개선
- 중복 제거, 네이밍 개선, 구조 정리
- 매직 넘버를 상수로 추출

```java
public class PasswordValidator {
    private static final int MIN_LENGTH = 8;
    private static final int MAX_LENGTH = 16;

    public static void validate(String password) {
        if (password.length() < MIN_LENGTH) {
            throw new IllegalArgumentException("비밀번호는 " + MIN_LENGTH + "자 이상이어야 합니다.");
        }
    }
}
```

### 5단계: 반복

- 다음 테스트 케이스로 이동
- Red → Green → Refactor 사이클 반복
- 모든 요구사항이 구현될 때까지 진행

---

## 1차 과제

TDD 개발 방법론으로 요구 기능을 개발한다.  
단위 테스트 / 통합 테스트 / E2E 테스트 케이스를 필수로 구현하고, 모든 테스트를 통과시키는 것을 목표로 개발

### 1. 회원가입

- **필요 정보:** 로그인 ID, 비밀번호, 이름, 생년월일, 이메일
- 이미 가입된 로그인 ID로는 가입이 불가능함
- 각 정보는 포맷에 맞는 검증 필요 (이름, 이메일, 생년월일)
- 비밀번호는 암호화해 저장하며, 아래와 같은 규칙을 따름
  1. 8~16자의 영문 대소문자, 숫자, 특수문자만 가능합니다.
  2. 생년월일은 비밀번호 내에 포함될 수 없습니다.

### 2. 내 정보 조회

- **반환 정보:** 로그인 ID, 이름, 생년월일, 이메일
- 로그인 ID는 영문과 숫자만 허용
- 이름은 마지막 글자를 마스킹해 반환 (마스킹 문자: `*`)

### 3. 비밀번호 수정

- **필요 정보:** 기존 비밀번호, 새 비밀번호
- 비밀번호 RULE을 따르되, 현재 비밀번호는 사용할 수 없습니다.

> **인증 방식**
>
> 유저 정보가 필요한 모든 요청은 아래 헤더를 통해 요청
> - `X-Loopers-LoginId`: 로그인 ID
> - `X-Loopers-LoginPw`: 비밀번호

---

## 실습 문서

- [회원가입](./회원가입.md)
