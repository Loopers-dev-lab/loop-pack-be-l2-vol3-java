## 요구사항
사용자는 비밀번호를 변경할 수 있습니다.
- 필요 정보: 기존 비밀번호, 새 비밀번호
- 비밀번호 규칙을 따름
  1. 8~16자의 영문 대소문자, 숫자, 특수문자만 가능
  2. 생년월일은 비밀번호 내에 포함될 수 없음
- 현재 비밀번호와 동일한 비밀번호는 사용 불가
- 로그인 ID: `X-Loopers-LoginId`
- 로그인 PWD: `X-Loopers-LoginPw`

---

## 1단계: Layer별 책임 분리

#### Domain
- `User.changePassword(newEncodedPassword)`: 비밀번호 변경 메서드

#### Service
- 사용자 인증 (loginId, password 확인)
- 새 비밀번호 검증 (PasswordValidator 사용)
- 새 비밀번호가 기존 비밀번호와 동일한지 검증
- 비밀번호 암호화 및 저장

#### Controller/DTO
- `ChangePasswordRequest`: 기존 비밀번호, 새 비밀번호
- `PATCH /api/v1/users/password`
- 헤더: X-Loopers-LoginId, X-Loopers-LoginPw

## 2단계: 단위 테스트 (목록 추출 → 구현)

#### 테스트 목록
- [x] Domain: User.changePassword()로 비밀번호가 변경된다
- [x] Service: 올바른 기존 비밀번호로 비밀번호 변경에 성공한다
- [x] Service: 기존 비밀번호가 일치하지 않으면 예외가 발생한다
- [x] Service: 새 비밀번호가 기존 비밀번호와 동일하면 예외가 발생한다
- [x] Service: 새 비밀번호가 규칙에 맞지 않으면 예외가 발생한다

## 3단계: 통합 테스트 (목록 추출 → 구현)

#### 테스트 목록
- [x] DB에 저장된 사용자의 비밀번호가 정상적으로 변경된다
- [x] 기존 비밀번호가 일치하지 않으면 예외가 발생한다
- [x] 새 비밀번호가 기존과 동일하면 예외가 발생한다

## 4단계: E2E 테스트 (목록 추출 → 구현)

#### 테스트 목록
- [x] 비밀번호 변경 API 요청시 200 OK 반환
- [x] 기존 비밀번호가 일치하지 않으면 401 Unauthorized 반환
- [x] 새 비밀번호가 기존과 동일하면 400 Bad Request 반환
- [x] 비밀번호 규칙 위반시 400 Bad Request 반환
