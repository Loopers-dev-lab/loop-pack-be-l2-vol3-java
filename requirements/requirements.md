# 사용자(회원) 기능 요구사항 정의서

- 문서 버전: v1.0
- 작성일: 2026-02-04
- 범위: 회원가입 / 내 정보 조회 / 비밀번호 수정
- 비고: 본 문서는 API 형태를 전제로 하나, UI/채널에 종속되지 않음

---

## 1. 용어 정의

- 로그인 ID(LoginId): 사용자를 식별하는 고유 문자열
- 비밀번호(LoginPw): 인증을 위한 사용자 비밀 문자열(서버 저장 시 암호화)
- 생년월일(BirthDate): `YYYY-MM-DD` 형식의 날짜
- 마스킹(Masking): 특정 문자를 `*`로 치환해 노출을 제한하는 처리

---

## 2. 공통 정책

### 2.1 인증 헤더(유저 정보가 필요한 모든 요청)
유저 정보가 필요한 모든 요청은 아래 헤더를 반드시 포함한다.

- `X-Loopers-LoginId`: 로그인 ID
- `X-Loopers-LoginPw`: 비밀번호

> 인증 실패 시(헤더 누락/정보 불일치)는 공통 에러 규칙을 따른다.

### 2.2 데이터 검증(Validation) 공통 원칙
- 클라이언트 입력은 신뢰하지 않으며, 서버에서 재검증한다.
- 검증 실패 시 명확한 에러 사유를 반환한다(필드 단위 권장).

### 2.3 마스킹 규칙 공통
- 마스킹 문자는 `*`로 통일한다.

---

## 3. 기능 요구사항

## 3.1 회원가입(Sign Up)

### 3.1.1 목적
신규 사용자를 등록한다.

### 3.1.2 입력 정보(필수)
- 로그인 ID
- 비밀번호
- 이름
- 생년월일
- 이메일

### 3.1.3 처리 규칙
1. 로그인 ID 중복 불가
    - 이미 가입된 로그인 ID로는 가입이 불가능하다.
2. 입력 포맷 검증
    - 이름, 이메일, 생년월일은 포맷에 맞는 검증이 필요하다.
3. 비밀번호 저장 정책
    - 비밀번호는 암호화(해시)하여 저장한다(평문 저장 금지).
4. 비밀번호 규칙(회원가입)
    1) 8~16자의 영문 대소문자, 숫자, 특수문자만 가능합니다.
    2) 생년월일은 비밀번호 내에 포함될 수 없습니다.

### 3.1.4 예외/오류 조건
- 로그인 ID 중복
- 입력 포맷 불일치(이름/이메일/생년월일)
- 비밀번호 규칙 위반(길이/허용문자/생년월일 포함)

### 3.1.5 결과(성공)
- 회원가입 성공 여부를 반환한다.
- (선택) 성공 시 생성된 사용자 식별 정보(예: loginId)를 반환할 수 있다.

---

## 3.2 내 정보 조회(My Profile 조회)

### 3.2.1 목적
인증된 사용자의 정보를 조회한다.

### 3.2.2 입력(인증)
- 공통 인증 헤더 필수
    - `X-Loopers-LoginId`
    - `X-Loopers-LoginPw`

### 3.2.3 반환 정보
- 로그인 ID
- 이름
- 생년월일
- 이메일

### 3.2.4 처리 규칙
1. 로그인 ID 형식 제한
    - 로그인 ID는 영문과 숫자만 허용한다.
2. 이름 마스킹 처리
    - 이름은 마지막 글자를 마스킹하여 반환한다.
    - 마스킹 문자는 `*` 사용
    - 예시:
        - `홍길동` → `홍길*`
        - `A` → `*` (한 글자인 경우 전부 마스킹)

### 3.2.5 예외/오류 조건
- 인증 실패(헤더 누락/불일치)
- 로그인 ID 형식 위반(영문/숫자 외 포함)

---

## 3.3 비밀번호 수정(Change Password)

### 3.3.1 목적
인증된 사용자의 비밀번호를 변경한다.

### 3.3.2 입력 정보(필수)
- 기존 비밀번호
- 새 비밀번호

### 3.3.3 처리 규칙
1. 인증 필요
    - 공통 인증 헤더 필수
2. 기존 비밀번호 확인
    - 입력된 기존 비밀번호가 현재 비밀번호와 일치해야 한다.
3. 새 비밀번호 규칙 준수
    - 비밀번호 RULE을 따른다.
4. 현재 비밀번호 재사용 금지
    - 새 비밀번호는 현재 비밀번호와 동일할 수 없다.

### 3.3.4 비밀번호 RULE(변경)
- 영문 대/소문자, 숫자, 특수문자 사용 가능
- 생년월일 사용 불가

> (참고) 길이 제한(8~16) 등 추가 제약이 필요하다면 회원가입 규칙과 통일하는 것을 권장한다.

### 3.3.5 예외/오류 조건
- 인증 실패(헤더 누락/불일치)
- 기존 비밀번호 불일치
- 새 비밀번호가 현재 비밀번호와 동일
- 비밀번호 RULE 위반(허용문자/생년월일 포함)

---

## 4. 공통 에러 응답 정책(권장)

### 4.1 에러 응답 형식(예시)
```json
{
  "code": "VALIDATION_ERROR",
  "message": "입력값이 올바르지 않습니다.",
  "details": [
    { "field": "email", "reason": "이메일 형식이 올바르지 않습니다." }
  ]
}