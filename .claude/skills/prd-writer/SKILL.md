---
name: prd-writer
description: PRD + Acceptance Criteria 작성 가이드. 요구사항을 구조화된 명세서로 변환. "PRD 작성", "요구사항 분석", "AC 작성", "기능 명세" 요청 시 사용.
---

# PRD + AC Writer

원시 요구사항을 **구현 가능한 명세서**로 변환하는 브레인스토밍 가이드입니다.

## 워크플로우

```
Phase 0: CONTEXT (컨텍스트)
    ↓
Phase 1: CAPTURE (수집)
    ↓
Phase 2: CLARIFY (명확화) ←──┐
    ↓                        │
    └── 모호함 발견? ─────────┘
    ↓
Phase 3: STRUCTURE (구조화)
    ↓
Phase 4: VALIDATE (검증)
```

---

## Phase 0: CONTEXT (컨텍스트 파악)

PRD 작성 전 프로젝트의 기존 규칙과 구현 패턴을 파악합니다.

### 필수 읽기 파일
1. `.claude/rules/core/design-principles.md` - 설계 원칙
2. `.claude/rules/core/exception-patterns.md` - 예외 처리
3. `.claude/rules/core/project-conventions.md` - 프로젝트 컨벤션

### 확인 사항 체크리스트
- [ ] HTTP 상태코드 패턴 (200 vs 201 vs 204)
- [ ] 에러 응답 형식 (ErrorType 종류, 메시지 형식)
- [ ] 검증 위치 (Request DTO vs Domain Entity)
- [ ] 필드별 검증 규칙 표준

### 이 단계의 산출물
- 프로젝트 컨텍스트 요약
- PRD 작성 시 준수해야 할 규칙 목록

---

## Phase 1: CAPTURE (수집)

원시 요구사항에서 핵심 요소를 추출합니다.

### 추출할 정보
| 요소 | 질문 | 예시 |
|------|------|------|
| WHO | 누가 이 기능을 사용하는가? | 비회원, 회원, 관리자 |
| WHAT | 무엇을 할 수 있어야 하는가? | 회원가입, 로그인, 주문 |
| WHY | 왜 이 기능이 필요한가? | 서비스 이용을 위해 |
| WHEN | 언제 이 기능을 사용하는가? | 최초 방문 시 |
| CONSTRAINT | 제약 조건은 무엇인가? | 중복 ID 불가 |

### 이 단계의 산출물
- Feature 목록
- 각 Feature의 간단한 설명
- 우선순위 (P0/P1/P2)

---

## Phase 2: CLARIFY (명확화)

모호한 부분을 질문을 통해 명확하게 만듭니다.

### 모호함 탐지 체크리스트

#### 1. 데이터 관점
- [ ] 어떤 필드가 필요한가?
- [ ] 각 필드의 타입은?
- [ ] 필수/선택 구분은?
- [ ] 각 필드의 검증 규칙은?
- [ ] 최소/최대 길이는?
- [ ] 허용 문자는?

#### 2. 행위 관점
- [ ] 정상 동작은 어떻게 되는가?
- [ ] 실패하면 어떻게 되는가?
- [ ] 부분 성공은 가능한가?
- [ ] 롤백이 필요한가?

#### 3. 상태 관점
- [ ] 이 작업 전에 필요한 조건은?
- [ ] 이 작업 후 상태는 어떻게 변하는가?
- [ ] 다른 기능에 영향을 주는가?

#### 4. 보안 관점
- [ ] 인증이 필요한가?
- [ ] 권한 검사가 필요한가?
- [ ] 민감 정보가 있는가?
- [ ] 로깅이 필요한가?

#### 5. 비기능 관점
- [ ] 성능 요구사항은?
- [ ] 동시성 처리는?
- [ ] 캐싱이 필요한가?

### 질문 템플릿

```
[필드명]에 대해 확인이 필요합니다:
1. 타입: String / Integer / LocalDate / ...?
2. 필수 여부: Y / N?
3. 검증 규칙: (예: 4-20자, 영문소문자+숫자)
4. 기본값: (선택 필드인 경우)
```

```
[기능명]의 실패 케이스 확인:
1. [조건] 일 때 → 어떤 HTTP 상태코드? 어떤 메시지?
```

---

## Phase 3: STRUCTURE (구조화)

명확해진 요구사항을 템플릿에 맞게 정리합니다.

### Feature 구조

```markdown
## Feature N: [기능명]

### 개요
### API 명세
### Acceptance Criteria
### 결정 사항
### 미결 사항
```

### 좋은 Acceptance Criteria의 조건

#### INVEST 원칙
| 원칙 | 의미 | 체크 |
|------|------|------|
| **I**ndependent | 다른 AC와 독립적 | 단독 테스트 가능? |
| **N**egotiable | 협의 가능 | 구현 방법 유연? |
| **V**aluable | 가치 제공 | 사용자에게 의미? |
| **E**stimable | 추정 가능 | 구현 규모 파악? |
| **S**mall | 작은 단위 | 하나의 시나리오? |
| **T**estable | 테스트 가능 | 명확한 기대 결과? |

#### AC 작성 형식: 조건-행위-기대결과

```markdown
| AC# | 조건 | 행위 | 기대 결과 |
|-----|------|------|----------|
| AC-1 | 모든 필수값 유효 | POST /api/v1/users | 201, 회원 생성 |
```

#### 나쁜 AC vs 좋은 AC

❌ 나쁜 예:
- "비밀번호는 안전해야 한다" → 테스트 불가
- "빠르게 응답해야 한다" → 기준 없음
- "적절한 에러 처리" → 모호함

✅ 좋은 예:
- "비밀번호는 8자 이상, 영문+숫자+특수문자 포함"
- "응답 시간 200ms 이내"
- "loginId 중복 시 409 CONFLICT, 메시지: '이미 사용 중인 로그인 ID입니다'"

### 비즈니스 규칙 작성

```markdown
| 규칙# | 내용 | 구현 위치 |
|-------|------|----------|
| BR-1 | 비밀번호는 BCrypt로 암호화 | UserService |
```

구현 위치 가이드:
- **Entity**: 도메인 불변식 (생성 시 검증)
- **Service**: 비즈니스 로직 (중복 체크 등)
- **Controller**: 입력값 형식 검증
- **전체**: 시스템 전반 규칙

---

## Phase 4: VALIDATE (검증)

작성된 PRD가 완전한지 검증합니다.

### 완전성 체크리스트

#### API 명세
- [ ] 모든 필드에 타입이 명시되었는가?
- [ ] 모든 필드에 필수 여부가 명시되었는가?
- [ ] 모든 필드에 검증 규칙이 있는가?
- [ ] Response 필드가 정의되었는가?

#### Acceptance Criteria
- [ ] Happy Path가 정의되었는가?
- [ ] 모든 필수 필드 누락 케이스가 있는가?
- [ ] 모든 검증 실패 케이스가 있는가?
- [ ] 비즈니스 규칙 위반 케이스가 있는가?
- [ ] 모든 AC가 테스트 가능한가?

#### 의존성
- [ ] 선행 조건이 명시되었는가?
- [ ] 다른 Feature와의 관계가 명시되었는가?

### 누락 탐지 질문

각 Feature에 대해:
1. "이 API를 E2E 테스트한다면 어떤 시나리오가 필요한가?"
2. "이 기능이 실패할 수 있는 모든 경우는?"
3. "다른 기능에 영향을 주는 부분은?"

---

## 브레인스토밍 진행 가이드

### 시작하기

```
요구사항을 공유해주세요. 다음 형식 중 어떤 것이든 괜찮습니다:
- 원시 텍스트
- 기획 문서
- 화면 설계서
- 구두 설명

함께 PRD + AC로 정리해보겠습니다.
```

### 진행 중

```
[기능명]에 대해 다음이 명확하지 않습니다:
1. [질문1]
2. [질문2]

어떻게 처리할까요?
A) [옵션1]
B) [옵션2]
C) 다른 방식
```

### 마무리

```
[기능명] PRD가 완성되었습니다.

요약:
- API: [엔드포인트]
- AC: [N]개 (정상 [X]개, 실패 [Y]개)
- 비즈니스 규칙: [M]개

다음 기능으로 넘어갈까요, 아니면 수정할 부분이 있나요?
```

---

## 템플릿 & 예시

- 템플릿: [templates/prd-template.md](./templates/prd-template.md)
- 예시: [examples/user-feature.md](./examples/user-feature.md)
